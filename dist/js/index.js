let count=0,trans=0;setInterval(()=>{if(count+=1,!(count<8))return count=0,trans=0,document.querySelector(".slider").style.transitionDuration="0s",document.querySelector(".slider").style.transform=`translateX(${trans})`,!1;trans+=100,document.querySelector(".slider").style.transitionDuration="0.5s",document.querySelector(".slider").style.transform=`translateX(-${trans}vw)`},2e3);const client=contentful.createClient({space:"lkz2mlhiqx2q",accessToken:"pnnHBIR0sePphnO9bxYS_lYP53oHo85QzFKZ0QM9h64"});function handleCartButtons(t){if(t.preventDefault(),"BUTTON"==t.target.tagName){let e=t.target.dataset.id,r=model.getProductsFromLs().find(t=>t.id==e);r&&(model.addItemToLsCart(r),view.updateCart(),t.target.textContent="In Cart",t.target.disabled=!0,view.showAddAlert(r),document.querySelector(".alert").addEventListener("click",t=>{"BUTTON"==t.target.tagName&&(t.preventDefault(),t.currentTarget.innerHTML="",t.currentTarget.style.display="none")}))}else if("each-product"==t.target.className||"IMG"==t.target.tagName||"content-container"==t.target.className||"product-name"==t.target.className||"product-price"==t.target.className||"availability"==t.target.className||"product-price-val"==t.target.className)if("each-product"==t.target.className){let e=t.target.dataset.id;model.setCurrentItemInCart(e),window.location.href="../product.html"}else{let e=t.target.closest("a").dataset.id;model.setCurrentItemInCart(e),window.location.href="product.html"}}function bringIntoView(t){t.preventDefault(),"hero-button"==t.target.className&&document.querySelector(".featured").scrollIntoView({behavior:"smooth",block:"start",inline:"start"})}function handleNavBar(t){console.log("working"),document.querySelector(".nav-slide").classList.toggle("open"),t.preventDefault()}class Model{doesCurrentItemExistInLs(){return!!localStorage.getItem("shoeproci")}doesProductsExistInLs(){return!!localStorage.getItem("shoeproprods")}doesLatestProductsExistInLs(){return!!localStorage.getItem("shoeprolp")}doesGisExistInLs(){return!!localStorage.getItem("shoeprogis")}doesCartExistInLs(){return!!localStorage.getItem("shoeprocart")}getProductsFromLs(){return JSON.parse(localStorage.getItem("shoeproprods"))}getCartFromLs(){return JSON.parse(localStorage.getItem("shoeprocart"))}getLatestProductsFromLs(){return JSON.parse(localStorage.getItem("shoeprolp"))}getGisFromLs(){return JSON.parse(localStorage.getItem("shoeprogis"))}addItemToLsCart(t){let e;this.doesCartExistInLs()?(e=this.getCartFromLs(),t={...t,quantity:1},e.push(t),localStorage.setItem("shoeprocart",JSON.stringify(e))):(e=[],t={...t,quantity:1},e.push(t),localStorage.setItem("shoeprocart",JSON.stringify(e)))}addProductsToLs(t){this.doesProductsExistInLs()||localStorage.setItem("shoeproprods",JSON.stringify(t))}addGisToLs(t){this.doesGisExistInLs()||localStorage.setItem("shoeprogis",JSON.stringify(t))}addLatestProductsToLs(t){this.doesLatestProductsExistInLs()||localStorage.setItem("shoeprolp",JSON.stringify(t))}async fetchItemsFromJson(){try{let t=(await client.getEntries({content_type:"productDetails"})).items[0].fields.json.items,e=t.map(callback.deconstructFetchResult),r=t.filter(callback.findLatestProducts);r=r.map(callback.deconstructProductsCat).sort(callback.sortProductsCat);let a=t.filter(callback.findGoodsInStock);return a=a.map(callback.deconstructProductsCat).sort(callback.sortProductsCat),{products:e,latestProducts:r,goodsInStock:a}}catch(t){console.log(t.message)}}createCartInLs(){this.doesCartExistInLs()||localStorage.setItem("shoeprocart",JSON.stringify([]))}createCurrentItemInLs(){this.doesCurrentItemExistInLs()||localStorage.setItem("shoeproci",JSON.stringify([]))}setCurrentItemInCart(t){if(model.doesCurrentItemExistInLs()){let e=JSON.parse(localStorage.getItem("shoeproci"));0==e.length?(e.push(t),localStorage.setItem("shoeproci",JSON.stringify(e))):(e.splice(0,1,t),localStorage.setItem("shoeproci",JSON.stringify(e)))}}}const model=new Model;class View{displayLatestProducts(t){let e="";t.forEach(t=>{e+=`\n      <a href="./product.html" data-id="${t.id}" class="each-product">\n            <div class="img-container">\n              <img src="${t.url}" alt="">\n            </div>\n            <div class="content-container">\n              <p class="product-name">${t.title}</p>\n              <p class="product-price">Price: &nbsp;<span class="product-price-val" >${t.price.toLocaleString()}</span></p>\n              <p class="availability">Availability: &nbsp;<span class="av-value">${t.availability}</span></p>\n              <button data-id="${t.id}" >Add to cart</button>\n            </div>\n          </a>\n      `}),document.querySelector(".inner-container-lp").innerHTML=e}displayGoodsInStock(t){let e="";t.forEach(t=>{e+=`\n      <a href="./product.html" data-id="${t.id}" class="each-product">\n            <div class="img-container">\n              <img src="${t.url}" alt="">\n            </div>\n            <div class="content-container">\n              <p class="product-name">${t.title}</p>\n              <p class="product-price">Price: &nbsp;<span class="product-price-val" >${t.price.toLocaleString()}</span></p>\n              <p class="availability">Availability: &nbsp;<span class="av-value">${t.availability}</span></p>\n              <button data-id="${t.id}" >Add to cart</button>\n            </div>\n          </a>\n      `}),document.querySelector(".inner-container-gis").innerHTML=e}updateCart(){let t=model.getCartFromLs();document.querySelector(".cart-value").textContent=t.length}confirmIfItemInCart(){Array.from(document.querySelectorAll(".each-product button")).forEach(t=>{let e=t.dataset.id;model.getCartFromLs().find(t=>t.id==e)&&(t.textContent="In Cart",t.disabled=!0)})}showAddAlert(t){let e=`\n    <div class="alert-inner">\n      <h3 class="alert-header">Item Added to Cart</h3>\n      <div class="alert-img">\n        <img src="${t.url}" alt="">\n      </div>\n      <p class="alert-name">${t.title}</p>\n      <p class="alert-price">Price: <span class="alert-price-value">${t.price.toLocaleString()}</span></p>\n      <button class="alert-cs">Continue Shopping</button>\n      <a href="./cart.html" class="alert-gtc">Go To Cart</a>\n    </div>\n    `;document.querySelector(".alert").style.display="flex",document.querySelector(".alert").innerHTML=e}}const view=new View;class Controller{init(){document.addEventListener("DOMContentLoaded",()=>{if(document.querySelector(".current-year").textContent=(new Date).getFullYear(),document.querySelector(".close").addEventListener("click",t=>{document.querySelector(".nav-slide").classList.remove("open"),t.preventDefault()}),document.querySelector(".menu").addEventListener("click",handleNavBar),document.querySelector(".inner-container-lp").addEventListener("click",handleCartButtons),document.querySelector(".inner-container-gis").addEventListener("click",handleCartButtons),document.querySelector(".display-test").addEventListener("click",bringIntoView),model.doesProductsExistInLs()){let t=model.getLatestProductsFromLs(),e=model.getGisFromLs();view.displayGoodsInStock(e),view.displayLatestProducts(t),model.createCartInLs(),model.createCurrentItemInLs(),view.updateCart(),view.confirmIfItemInCart()}else model.fetchItemsFromJson().then(t=>{view.displayLatestProducts(t.latestProducts),view.displayGoodsInStock(t.goodsInStock),model.addProductsToLs(t.products),model.addGisToLs(t.goodsInStock),model.addLatestProductsToLs(t.latestProducts),model.createCartInLs(),model.createCurrentItemInLs(),view.updateCart(),view.confirmIfItemInCart()})})}}const controller=new Controller;class Callback{deconstructFetchResult(t){let{title:e,price:r,brand:a,description:s,availability:o,category:n}=t.fields,{id:l}=t.sys,{url:c}=t.fields.image.fields.file;return{title:e,price:r,brand:a,description:s,availability:o,category:n,id:l,url:c}}deconstructProductsCat(t){let{title:e,price:r,brand:a,description:s,availability:o,category:n,attr:l}=t.fields,{id:c}=t.sys,{url:i}=t.fields.image.fields.file;return{title:e,price:r,brand:a,description:s,attr:l,availability:o,category:n,id:c,url:i}}findLatestProducts(t){return"latest products"===t.fields.attr}findGoodsInStock(t){return"goods in stock"===t.fields.attr}sortProductsCat(t,e){return t.price-e.price}}const callback=new Callback;controller.init();